(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[945],{619:function(e,s,t){Promise.resolve().then(t.bind(t,7619))},7619:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return T}});var a=t(7821),l=t(8078),n=t(8504),i=t(5407),r=t(7769),c=t(7469),d=t(7918),o=t(3662),x=t(6576);let m=(0,x.Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);var h=t(9523),u=t(2021),j=t(9044),g=t(9781),p=t(2758),N=t(3778),b=t(5189),v=t(1844);let f=(0,x.Z)("Unlink",[["path",{d:"m18.84 12.25 1.72-1.71h-.02a5.004 5.004 0 0 0-.12-7.07 5.006 5.006 0 0 0-6.95 0l-1.72 1.71",key:"yqzxt4"}],["path",{d:"m5.17 11.75-1.71 1.71a5.004 5.004 0 0 0 .12 7.07 5.006 5.006 0 0 0 6.95 0l1.71-1.71",key:"4qinb0"}],["line",{x1:"8",x2:"8",y1:"2",y2:"5",key:"1041cp"}],["line",{x1:"2",x2:"5",y1:"8",y2:"8",key:"14m1p5"}],["line",{x1:"16",x2:"16",y1:"19",y2:"22",key:"rzdirn"}],["line",{x1:"19",x2:"22",y1:"16",y2:"16",key:"ox905f"}]]);var y=t(6625),k=t(9892),w=t(1232),C=t(1138),E=t(7344),A=t(4680);let D={[k.lC.SAVINGS]:"bg-green-100 text-green-800",[k.lC.DEBT_PAYOFF]:"bg-red-100 text-red-800",[k.lC.INVESTMENT]:"bg-blue-100 text-blue-800",[k.lC.EMERGENCY_FUND]:"bg-orange-100 text-orange-800",[k.lC.EDUCATION]:"bg-purple-100 text-purple-800",[k.lC.HOUSE]:"bg-indigo-100 text-indigo-800",[k.lC.VACATION]:"bg-pink-100 text-pink-800",[k.lC.RETIREMENT]:"bg-gray-100 text-gray-800",[k.lC.OTHER]:"bg-yellow-100 text-yellow-800"};function T(){var e,s;let t=(0,n.useParams)(),x=(0,n.useRouter)(),[k,T]=(0,l.useState)(null),[I,Z]=(0,l.useState)(!0),[G,V]=(0,l.useState)([]),[z,O]=(0,l.useState)(!1),[S,L]=(0,l.useState)(!1),[_,F]=(0,l.useState)(!1);(0,l.useEffect)(()=>{t.id&&(P(),R())},[t.id]);let P=async()=>{try{Z(!0);let e=await fetch("/api/goals/".concat(t.id));if(e.ok){let s=await e.json();T(s)}else A.Am.error("Failed to load goal details")}catch(e){console.error("Error fetching goal detail:",e),A.Am.error("Error loading goal details")}finally{Z(!1)}},R=async()=>{try{let e=await fetch("/api/investments?includeGoals=true");if(e.ok){let s=await e.json();V(s)}}catch(e){console.error("Error fetching investments:",e)}},M=async e=>{try{(await fetch("/api/goals/".concat(t.id,"/investments/").concat(e),{method:"DELETE"})).ok?(P(),R(),A.Am.success("Investment unlinked successfully!")):A.Am.error("Failed to unlink investment")}catch(e){console.error("Error unlinking investment:",e),A.Am.error("Error unlinking investment")}},U=async()=>{if(confirm("Are you sure you want to delete this goal? This action cannot be undone."))try{(await fetch("/api/goals/".concat(t.id),{method:"DELETE"})).ok?(A.Am.success("Goal deleted successfully!"),x.push("/goals")):A.Am.error("Failed to delete goal")}catch(e){console.error("Error deleting goal:",e),A.Am.error("Error deleting goal")}};if(I)return(0,a.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,a.jsxs)("div",{className:"animate-pulse space-y-6",children:[(0,a.jsx)("div",{className:"h-8 bg-slate-200 rounded w-1/4"}),(0,a.jsx)("div",{className:"h-64 bg-slate-200 rounded"})]})});if(!k)return(0,a.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-slate-900",children:"Goal not found"}),(0,a.jsxs)(c.z,{onClick:()=>x.push("/goals"),className:"mt-4",children:[(0,a.jsx)(m,{className:"h-4 w-4 mr-2"}),"Back to Goals"]})]})});let Y=[...(null===(e=k.investmentLinks)||void 0===e?void 0:e.map(e=>({...e.investment,linkId:e.id,allocation:e.allocation,allocatedValue:e.investment.currentValue*(e.allocation/100),linkType:"linked"})))||[],...(null===(s=k.investments)||void 0===s?void 0:s.map(e=>({...e,linkId:null,allocation:100,allocatedValue:e.currentValue,linkType:"direct"})))||[]],B=Math.max(0,k.targetAmount-k.totalProgress),H=Math.min(k.totalProgress/k.targetAmount*100,100);return(0,a.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,a.jsxs)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"space-y-8",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)(c.z,{variant:"outline",onClick:()=>x.push("/goals"),children:[(0,a.jsx)(m,{className:"h-4 w-4 mr-2"}),"Back to Goals"]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h1",{className:"text-3xl font-bold text-slate-900 flex items-center gap-3",children:[(0,a.jsx)("div",{className:"p-2 bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg",children:(0,a.jsx)(h.Z,{className:"h-6 w-6 text-white"})}),k.name]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,a.jsx)(d.C,{className:D[k.goalType],children:k.goalType.replace("_"," ")}),(0,a.jsx)(d.C,{variant:"ACTIVE"===k.status?"default":"secondary",children:k.status})]})]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(c.z,{variant:"outline",onClick:()=>L(!0),children:[(0,a.jsx)(u.Z,{className:"h-4 w-4 mr-2"}),"Edit Goal"]}),(0,a.jsxs)(c.z,{variant:"outline",className:"text-red-600 border-red-600 hover:bg-red-50",onClick:U,children:[(0,a.jsx)(j.Z,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,a.jsx)("div",{className:"lg:col-span-2",children:(0,a.jsxs)(r.Zb,{children:[(0,a.jsx)(r.Ol,{children:(0,a.jsx)(r.ll,{children:"Goal Progress"})}),(0,a.jsxs)(r.aY,{className:"space-y-6",children:[k.description&&(0,a.jsx)("p",{className:"text-slate-600",children:k.description}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-slate-600",children:"Overall Progress"}),(0,a.jsxs)("span",{className:"font-medium",children:[H.toFixed(1),"%"]})]}),(0,a.jsx)(o.E,{value:H,className:"h-3"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[(0,a.jsx)(g.Z,{className:"h-6 w-6 text-blue-600 mx-auto mb-2"}),(0,a.jsx)("p",{className:"text-sm text-slate-600",children:"Target"}),(0,a.jsx)("p",{className:"font-semibold text-blue-600",children:(0,y.xG)(k.targetAmount)})]}),(0,a.jsxs)("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[(0,a.jsx)(p.Z,{className:"h-6 w-6 text-green-600 mx-auto mb-2"}),(0,a.jsx)("p",{className:"text-sm text-slate-600",children:"Contributions"}),(0,a.jsx)("p",{className:"font-semibold text-green-600",children:(0,y.xG)(k.currentAmount)})]}),(0,a.jsxs)("div",{className:"text-center p-4 bg-purple-50 rounded-lg",children:[(0,a.jsx)(h.Z,{className:"h-6 w-6 text-purple-600 mx-auto mb-2"}),(0,a.jsx)("p",{className:"text-sm text-slate-600",children:"Investments"}),(0,a.jsx)("p",{className:"font-semibold text-purple-600",children:(0,y.xG)(k.linkedInvestmentValue)})]}),(0,a.jsxs)("div",{className:"text-center p-4 bg-orange-50 rounded-lg",children:[(0,a.jsx)(N.Z,{className:"h-6 w-6 text-orange-600 mx-auto mb-2"}),(0,a.jsx)("p",{className:"text-sm text-slate-600",children:"Remaining"}),(0,a.jsx)("p",{className:"font-semibold text-orange-600",children:(0,y.xG)(B)})]})]}),k.targetDate&&(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[(0,a.jsx)(N.Z,{className:"h-4 w-4"}),(0,a.jsxs)("span",{children:["Target Date: ",new Date(k.targetDate).toLocaleDateString()]})]})]})]})}),(0,a.jsx)("div",{children:(0,a.jsxs)(r.Zb,{children:[(0,a.jsx)(r.Ol,{children:(0,a.jsx)(r.ll,{children:"Quick Actions"})}),(0,a.jsxs)(r.aY,{className:"space-y-3",children:[(0,a.jsxs)(c.z,{className:"w-full",onClick:()=>O(!0),disabled:"ACTIVE"!==k.status,children:[(0,a.jsx)(b.Z,{className:"h-4 w-4 mr-2"}),"Add Contribution"]}),(0,a.jsxs)(c.z,{variant:"outline",className:"w-full",onClick:()=>F(!0),disabled:"ACTIVE"!==k.status,children:[(0,a.jsx)(v.Z,{className:"h-4 w-4 mr-2"}),"Link Investment"]}),(0,a.jsxs)(c.z,{variant:"outline",className:"w-full",onClick:()=>L(!0),children:[(0,a.jsx)(u.Z,{className:"h-4 w-4 mr-2"}),"Edit Goal"]})]})]})})]}),(0,a.jsxs)(r.Zb,{children:[(0,a.jsx)(r.Ol,{children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)(r.ll,{children:["Linked Investments (",Y.length,")"]}),(0,a.jsxs)(c.z,{variant:"outline",onClick:()=>F(!0),disabled:"ACTIVE"!==k.status,children:[(0,a.jsx)(b.Z,{className:"h-4 w-4 mr-2"}),"Link Investment"]})]})}),(0,a.jsx)(r.aY,{children:0===Y.length?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(h.Z,{className:"h-12 w-12 text-slate-400 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"No investments linked"}),(0,a.jsx)("p",{className:"text-slate-600 mb-4",children:"Link investments to track their contribution to this goal"}),(0,a.jsxs)(c.z,{onClick:()=>F(!0),disabled:"ACTIVE"!==k.status,children:[(0,a.jsx)(v.Z,{className:"h-4 w-4 mr-2"}),"Link Investment"]})]}):(0,a.jsx)("div",{className:"space-y-4",children:Y.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border border-slate-200 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("div",{className:"p-2 rounded-full bg-slate-100",children:(0,a.jsx)(p.Z,{className:"h-4 w-4 text-blue-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold text-slate-900",children:e.name}),(0,a.jsxs)("p",{className:"text-sm text-slate-600",children:[e.assetClass," â€¢ ",e.allocation,"% allocation"]})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("div",{className:"text-lg font-bold text-green-600",children:(0,y.xG)(e.allocatedValue)}),(0,a.jsxs)("p",{className:"text-sm text-slate-600",children:["of ",(0,y.xG)(e.currentValue)]}),"linked"===e.linkType&&(0,a.jsxs)(c.z,{variant:"ghost",size:"sm",onClick:()=>M(e.linkId),className:"text-red-600 hover:text-red-700 mt-1",children:[(0,a.jsx)(f,{className:"h-3 w-3 mr-1"}),"Unlink"]})]})]},e.id))})})]}),(0,a.jsxs)(r.Zb,{children:[(0,a.jsx)(r.Ol,{children:(0,a.jsx)(r.ll,{children:"Recent Contributions"})}),(0,a.jsx)(r.aY,{children:0===k.contributions.length?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(b.Z,{className:"h-12 w-12 text-slate-400 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"No contributions yet"}),(0,a.jsx)("p",{className:"text-slate-600 mb-4",children:"Start contributing to reach your goal faster"}),(0,a.jsxs)(c.z,{onClick:()=>O(!0),disabled:"ACTIVE"!==k.status,children:[(0,a.jsx)(b.Z,{className:"h-4 w-4 mr-2"}),"Add Contribution"]})]}):(0,a.jsx)("div",{className:"space-y-3",children:k.contributions.slice(0,5).map(e=>(0,a.jsxs)("div",{className:"flex justify-between items-center p-3 bg-slate-50 rounded-lg",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:(0,y.xG)(e.amount)}),e.note&&(0,a.jsx)("p",{className:"text-sm text-slate-600",children:e.note})]}),(0,a.jsx)("p",{className:"text-sm text-slate-500",children:new Date(e.createdAt).toLocaleDateString()})]},e.id))})})]})]}),k&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(w.m,{open:z,onOpenChange:O,goal:{...k,targetDate:k.targetDate?new Date(k.targetDate):void 0,createdAt:new Date(k.createdAt),updatedAt:new Date(k.updatedAt),contributions:k.contributions||[]},onContributionAdded:()=>{P(),O(!1)}}),(0,a.jsx)(C.V,{open:S,onOpenChange:L,goal:{...k,targetDate:k.targetDate?new Date(k.targetDate):void 0,createdAt:new Date(k.createdAt),updatedAt:new Date(k.updatedAt),contributions:k.contributions||[]},onGoalUpdated:()=>{P(),L(!1)}}),(0,a.jsx)(E.a,{open:_,onOpenChange:F,goalId:k.id,onInvestmentLinked:()=>{P(),R(),F(!1)}})]})]})}}},function(e){e.O(0,[787,646,75,815,800,345,115,364,744],function(){return e(e.s=619)}),_N_E=e.O()}]);