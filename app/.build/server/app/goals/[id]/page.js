(()=>{var e={};e.id=6945,e.ids=[6945],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1600:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>i.a,__next_app__:()=>m,originalPathname:()=>x,pages:()=>d,routeModule:()=>u,tree:()=>o}),s(6543),s(4364),s(2874);var a=s(7105),l=s(5265),n=s(157),i=s.n(n),r=s(4665),c={};for(let e in r)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>r[e]);s.d(t,c);let o=["",{children:["goals",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,6543)),"/home/ubuntu/moneymitra/app/app/goals/[id]/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,4364)),"/home/ubuntu/moneymitra/app/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,2874,23)),"next/dist/client/components/not-found-error"]}],d=["/home/ubuntu/moneymitra/app/app/goals/[id]/page.tsx"],x="/goals/[id]/page",m={require:s,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:l.x.APP_PAGE,page:"/goals/[id]/page",pathname:"/goals/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},4914:(e,t,s)=>{Promise.resolve().then(s.bind(s,9751))},9751:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>T});var a=s(9899),l=s(5507),n=s(6153),i=s(5767),r=s(5858),c=s(7241),o=s(6523),d=s(2338),x=s(1278);let m=(0,x.Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);var u=s(6903),h=s(9118),p=s(4672),g=s(9804),j=s(9205),N=s(8408),b=s(7067),v=s(6019);let y=(0,x.Z)("Unlink",[["path",{d:"m18.84 12.25 1.72-1.71h-.02a5.004 5.004 0 0 0-.12-7.07 5.006 5.006 0 0 0-6.95 0l-1.72 1.71",key:"yqzxt4"}],["path",{d:"m5.17 11.75-1.71 1.71a5.004 5.004 0 0 0 .12 7.07 5.006 5.006 0 0 0 6.95 0l1.71-1.71",key:"4qinb0"}],["line",{x1:"8",x2:"8",y1:"2",y2:"5",key:"1041cp"}],["line",{x1:"2",x2:"5",y1:"8",y2:"8",key:"14m1p5"}],["line",{x1:"16",x2:"16",y1:"19",y2:"22",key:"rzdirn"}],["line",{x1:"19",x2:"22",y1:"16",y2:"16",key:"ox905f"}]]);var f=s(4359),k=s(1581),w=s(7669),A=s(4940),C=s(1544),E=s(2759);let D={[k.lC.SAVINGS]:"bg-green-100 text-green-800",[k.lC.DEBT_PAYOFF]:"bg-red-100 text-red-800",[k.lC.INVESTMENT]:"bg-blue-100 text-blue-800",[k.lC.EMERGENCY_FUND]:"bg-orange-100 text-orange-800",[k.lC.EDUCATION]:"bg-purple-100 text-purple-800",[k.lC.HOUSE]:"bg-indigo-100 text-indigo-800",[k.lC.VACATION]:"bg-pink-100 text-pink-800",[k.lC.RETIREMENT]:"bg-gray-100 text-gray-800",[k.lC.OTHER]:"bg-yellow-100 text-yellow-800"};function T(){let e=(0,n.useParams)(),t=(0,n.useRouter)(),[s,x]=(0,l.useState)(null),[k,T]=(0,l.useState)(!0),[I,Z]=(0,l.useState)([]),[G,P]=(0,l.useState)(!1),[_,V]=(0,l.useState)(!1),[z,O]=(0,l.useState)(!1),S=async()=>{try{T(!0);let t=await fetch(`/api/goals/${e.id}`);if(t.ok){let e=await t.json();x(e)}else E.Am.error("Failed to load goal details")}catch(e){console.error("Error fetching goal detail:",e),E.Am.error("Error loading goal details")}finally{T(!1)}},L=async()=>{try{let e=await fetch("/api/investments?includeGoals=true");if(e.ok){let t=await e.json();Z(t)}}catch(e){console.error("Error fetching investments:",e)}},q=async t=>{try{(await fetch(`/api/goals/${e.id}/investments/${t}`,{method:"DELETE"})).ok?(S(),L(),E.Am.success("Investment unlinked successfully!")):E.Am.error("Failed to unlink investment")}catch(e){console.error("Error unlinking investment:",e),E.Am.error("Error unlinking investment")}},M=async()=>{if(confirm("Are you sure you want to delete this goal? This action cannot be undone."))try{(await fetch(`/api/goals/${e.id}`,{method:"DELETE"})).ok?(E.Am.success("Goal deleted successfully!"),t.push("/goals")):E.Am.error("Failed to delete goal")}catch(e){console.error("Error deleting goal:",e),E.Am.error("Error deleting goal")}};if(k)return a.jsx("div",{className:"container mx-auto px-4 py-8",children:(0,a.jsxs)("div",{className:"animate-pulse space-y-6",children:[a.jsx("div",{className:"h-8 bg-slate-200 rounded w-1/4"}),a.jsx("div",{className:"h-64 bg-slate-200 rounded"})]})});if(!s)return a.jsx("div",{className:"container mx-auto px-4 py-8",children:(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Goal not found"}),(0,a.jsxs)(c.z,{onClick:()=>t.push("/goals"),className:"mt-4",children:[a.jsx(m,{className:"h-4 w-4 mr-2"}),"Back to Goals"]})]})});let F=[...s.investmentLinks?.map(e=>({...e.investment,linkId:e.id,allocation:e.allocation,allocatedValue:e.investment.currentValue*(e.allocation/100),linkType:"linked"}))||[],...s.investments?.map(e=>({...e,linkId:null,allocation:100,allocatedValue:e.currentValue,linkType:"direct"}))||[]],R=Math.max(0,s.targetAmount-s.totalProgress),U=Math.min(s.totalProgress/s.targetAmount*100,100);return(0,a.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,a.jsxs)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"space-y-8",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)(c.z,{variant:"outline",onClick:()=>t.push("/goals"),children:[a.jsx(m,{className:"h-4 w-4 mr-2"}),"Back to Goals"]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h1",{className:"text-3xl font-bold text-slate-900 flex items-center gap-3",children:[a.jsx("div",{className:"p-2 bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg",children:a.jsx(u.Z,{className:"h-6 w-6 text-white"})}),s.name]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[a.jsx(o.C,{className:D[s.goalType],children:s.goalType.replace("_"," ")}),a.jsx(o.C,{variant:"ACTIVE"===s.status?"default":"secondary",children:s.status})]})]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(c.z,{variant:"outline",onClick:()=>V(!0),children:[a.jsx(h.Z,{className:"h-4 w-4 mr-2"}),"Edit Goal"]}),(0,a.jsxs)(c.z,{variant:"outline",className:"text-red-600 border-red-600 hover:bg-red-50",onClick:M,children:[a.jsx(p.Z,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[a.jsx("div",{className:"lg:col-span-2",children:(0,a.jsxs)(r.Zb,{children:[a.jsx(r.Ol,{children:a.jsx(r.ll,{children:"Goal Progress"})}),(0,a.jsxs)(r.aY,{className:"space-y-6",children:[s.description&&a.jsx("p",{className:"text-slate-600",children:s.description}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-slate-600",children:"Overall Progress"}),(0,a.jsxs)("span",{className:"font-medium",children:[U.toFixed(1),"%"]})]}),a.jsx(d.E,{value:U,className:"h-3"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[a.jsx(g.Z,{className:"h-6 w-6 text-blue-600 mx-auto mb-2"}),a.jsx("p",{className:"text-sm text-slate-600",children:"Target"}),a.jsx("p",{className:"font-semibold text-blue-600",children:(0,f.xG)(s.targetAmount)})]}),(0,a.jsxs)("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[a.jsx(j.Z,{className:"h-6 w-6 text-green-600 mx-auto mb-2"}),a.jsx("p",{className:"text-sm text-slate-600",children:"Contributions"}),a.jsx("p",{className:"font-semibold text-green-600",children:(0,f.xG)(s.currentAmount)})]}),(0,a.jsxs)("div",{className:"text-center p-4 bg-purple-50 rounded-lg",children:[a.jsx(u.Z,{className:"h-6 w-6 text-purple-600 mx-auto mb-2"}),a.jsx("p",{className:"text-sm text-slate-600",children:"Investments"}),a.jsx("p",{className:"font-semibold text-purple-600",children:(0,f.xG)(s.linkedInvestmentValue)})]}),(0,a.jsxs)("div",{className:"text-center p-4 bg-orange-50 rounded-lg",children:[a.jsx(N.Z,{className:"h-6 w-6 text-orange-600 mx-auto mb-2"}),a.jsx("p",{className:"text-sm text-slate-600",children:"Remaining"}),a.jsx("p",{className:"font-semibold text-orange-600",children:(0,f.xG)(R)})]})]}),s.targetDate&&(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[a.jsx(N.Z,{className:"h-4 w-4"}),(0,a.jsxs)("span",{children:["Target Date: ",new Date(s.targetDate).toLocaleDateString()]})]})]})]})}),a.jsx("div",{children:(0,a.jsxs)(r.Zb,{children:[a.jsx(r.Ol,{children:a.jsx(r.ll,{children:"Quick Actions"})}),(0,a.jsxs)(r.aY,{className:"space-y-3",children:[(0,a.jsxs)(c.z,{className:"w-full",onClick:()=>P(!0),disabled:"ACTIVE"!==s.status,children:[a.jsx(b.Z,{className:"h-4 w-4 mr-2"}),"Add Contribution"]}),(0,a.jsxs)(c.z,{variant:"outline",className:"w-full",onClick:()=>O(!0),disabled:"ACTIVE"!==s.status,children:[a.jsx(v.Z,{className:"h-4 w-4 mr-2"}),"Link Investment"]}),(0,a.jsxs)(c.z,{variant:"outline",className:"w-full",onClick:()=>V(!0),children:[a.jsx(h.Z,{className:"h-4 w-4 mr-2"}),"Edit Goal"]})]})]})})]}),(0,a.jsxs)(r.Zb,{children:[a.jsx(r.Ol,{children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)(r.ll,{children:["Linked Investments (",F.length,")"]}),(0,a.jsxs)(c.z,{variant:"outline",onClick:()=>O(!0),disabled:"ACTIVE"!==s.status,children:[a.jsx(b.Z,{className:"h-4 w-4 mr-2"}),"Link Investment"]})]})}),a.jsx(r.aY,{children:0===F.length?(0,a.jsxs)("div",{className:"text-center py-8",children:[a.jsx(u.Z,{className:"h-12 w-12 text-slate-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"No investments linked"}),a.jsx("p",{className:"text-slate-600 mb-4",children:"Link investments to track their contribution to this goal"}),(0,a.jsxs)(c.z,{onClick:()=>O(!0),disabled:"ACTIVE"!==s.status,children:[a.jsx(v.Z,{className:"h-4 w-4 mr-2"}),"Link Investment"]})]}):a.jsx("div",{className:"space-y-4",children:F.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border border-slate-200 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[a.jsx("div",{className:"p-2 rounded-full bg-slate-100",children:a.jsx(j.Z,{className:"h-4 w-4 text-blue-600"})}),(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"font-semibold text-slate-900",children:e.name}),(0,a.jsxs)("p",{className:"text-sm text-slate-600",children:[e.assetClass," â€¢ ",e.allocation,"% allocation"]})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[a.jsx("div",{className:"text-lg font-bold text-green-600",children:(0,f.xG)(e.allocatedValue)}),(0,a.jsxs)("p",{className:"text-sm text-slate-600",children:["of ",(0,f.xG)(e.currentValue)]}),"linked"===e.linkType&&(0,a.jsxs)(c.z,{variant:"ghost",size:"sm",onClick:()=>q(e.linkId),className:"text-red-600 hover:text-red-700 mt-1",children:[a.jsx(y,{className:"h-3 w-3 mr-1"}),"Unlink"]})]})]},e.id))})})]}),(0,a.jsxs)(r.Zb,{children:[a.jsx(r.Ol,{children:a.jsx(r.ll,{children:"Recent Contributions"})}),a.jsx(r.aY,{children:0===s.contributions.length?(0,a.jsxs)("div",{className:"text-center py-8",children:[a.jsx(b.Z,{className:"h-12 w-12 text-slate-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"No contributions yet"}),a.jsx("p",{className:"text-slate-600 mb-4",children:"Start contributing to reach your goal faster"}),(0,a.jsxs)(c.z,{onClick:()=>P(!0),disabled:"ACTIVE"!==s.status,children:[a.jsx(b.Z,{className:"h-4 w-4 mr-2"}),"Add Contribution"]})]}):a.jsx("div",{className:"space-y-3",children:s.contributions.slice(0,5).map(e=>(0,a.jsxs)("div",{className:"flex justify-between items-center p-3 bg-slate-50 rounded-lg",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"font-medium",children:(0,f.xG)(e.amount)}),e.note&&a.jsx("p",{className:"text-sm text-slate-600",children:e.note})]}),a.jsx("p",{className:"text-sm text-slate-500",children:new Date(e.createdAt).toLocaleDateString()})]},e.id))})})]})]}),s&&(0,a.jsxs)(a.Fragment,{children:[a.jsx(w.m,{open:G,onOpenChange:P,goal:{...s,targetDate:s.targetDate?new Date(s.targetDate):void 0,createdAt:new Date(s.createdAt),updatedAt:new Date(s.updatedAt),contributions:s.contributions||[]},onContributionAdded:()=>{S(),P(!1)}}),a.jsx(A.V,{open:_,onOpenChange:V,goal:{...s,targetDate:s.targetDate?new Date(s.targetDate):void 0,createdAt:new Date(s.createdAt),updatedAt:new Date(s.updatedAt),contributions:s.contributions||[]},onGoalUpdated:()=>{S(),V(!1)}}),a.jsx(C.a,{open:z,onOpenChange:O,goalId:s.id,onInvestmentLinked:()=>{S(),L(),O(!1)}})]})]})}},6543:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});let a=(0,s(2772).createProxy)(String.raw`/home/ubuntu/moneymitra/app/app/goals/[id]/page.tsx#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[5942,300,3199,1523,814,6142,3535],()=>s(1600));module.exports=a})();