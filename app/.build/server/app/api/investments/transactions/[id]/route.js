"use strict";(()=>{var t={};t.id=9288,t.ids=[9288],t.modules={399:t=>{t.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:t=>{t.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},7692:(t,e,n)=>{n.r(e),n.d(e,{originalPathname:()=>y,patchFetch:()=>h,requestAsyncStorage:()=>l,routeModule:()=>c,serverHooks:()=>v,staticGenerationAsyncStorage:()=>m});var a={};n.r(a),n.d(a,{DELETE:()=>p,dynamic:()=>d});var i=n(921),r=n(7380),s=n(4185),o=n(3878),u=n(2334);let d="force-dynamic";async function p(t,{params:e}){try{let t=await u.db.investmentTransaction.findUnique({where:{id:e.id},include:{investment:!0}});if(!t)return o.NextResponse.json({error:"Transaction not found"},{status:404});let n=t.investment,a=n.quantity,i=n.totalInvested;if("BUY"===t.type||"SIP_INSTALLMENT"===t.type)a=Math.max(0,n.quantity-t.quantity),i=Math.max(0,n.totalInvested-t.amount);else if("SELL"===t.type){a=n.quantity+t.quantity;let e=t.quantity/(n.quantity+t.quantity);i=n.totalInvested/(1-e)}let r=a>0?i/a:0,s=a*n.currentPrice;return await u.db.investment.update({where:{id:n.id},data:{quantity:a,totalInvested:i,averagePrice:r,currentValue:s}}),await u.db.investmentTransaction.delete({where:{id:e.id}}),o.NextResponse.json({success:!0})}catch(t){return console.error("Error deleting investment transaction:",t),o.NextResponse.json({error:"Failed to delete investment transaction"},{status:500})}}let c=new i.AppRouteRouteModule({definition:{kind:r.x.APP_ROUTE,page:"/api/investments/transactions/[id]/route",pathname:"/api/investments/transactions/[id]",filename:"route",bundlePath:"app/api/investments/transactions/[id]/route"},resolvedPagePath:"/home/ubuntu/moneymitra/app/app/api/investments/transactions/[id]/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:l,staticGenerationAsyncStorage:m,serverHooks:v}=c,y="/api/investments/transactions/[id]/route";function h(){return(0,s.patchFetch)({serverHooks:v,staticGenerationAsyncStorage:m})}},2334:(t,e,n)=>{n.d(e,{db:()=>r,_:()=>i});let a=require("@prisma/client"),i=globalThis.prisma??new a.PrismaClient,r=i}};var e=require("../../../../../webpack-runtime.js");e.C(t);var n=t=>e(e.s=t),a=e.X(0,[5923,7146],()=>n(7692));module.exports=a})();