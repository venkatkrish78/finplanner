"use strict";(()=>{var e={};e.id=6781,e.ids=[6781],e.modules={3524:e=>{e.exports=require("@prisma/client")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4744:(e,E,t)=>{t.r(E),t.d(E,{originalPathname:()=>F,patchFetch:()=>g,requestAsyncStorage:()=>U,routeModule:()=>c,serverHooks:()=>p,staticGenerationAsyncStorage:()=>d});var n,A,a,N,T,r,i,L,S,I,O,R,D,o,s={};t.r(s),t.d(s,{POST:()=>Y,dynamic:()=>P});var C=t(3277),u=t(5265),l=t(5356),_=t(7076),M=t(6059);(function(e){e.INCOME="INCOME",e.EXPENSE="EXPENSE",e.TRANSFER="TRANSFER"})(n||(n={})),function(e){e.SUCCESS="SUCCESS",e.FAILED="FAILED",e.PENDING="PENDING"}(A||(A={})),function(e){e.MANUAL="MANUAL",e.SMS="SMS",e.EMAIL="EMAIL",e.BANK_STATEMENT="BANK_STATEMENT"}(a||(a={})),function(e){e.WEEKLY="WEEKLY",e.MONTHLY="MONTHLY",e.QUARTERLY="QUARTERLY",e.HALF_YEARLY="HALF_YEARLY",e.YEARLY="YEARLY",e.ONE_TIME="ONE_TIME"}(N||(N={})),function(e){e.PENDING="PENDING",e.PAID="PAID",e.OVERDUE="OVERDUE",e.CANCELLED="CANCELLED"}(T||(T={})),function(e){e.SAVINGS="SAVINGS",e.DEBT_PAYOFF="DEBT_PAYOFF",e.INVESTMENT="INVESTMENT",e.EMERGENCY_FUND="EMERGENCY_FUND",e.EDUCATION="EDUCATION",e.HOUSE="HOUSE",e.VACATION="VACATION",e.RETIREMENT="RETIREMENT",e.OTHER="OTHER"}(r||(r={})),function(e){e.ACTIVE="ACTIVE",e.COMPLETED="COMPLETED",e.PAUSED="PAUSED",e.CANCELLED="CANCELLED"}(i||(i={})),function(e){e.HOME_LOAN="HOME_LOAN",e.PERSONAL_LOAN="PERSONAL_LOAN",e.CAR_LOAN="CAR_LOAN",e.EDUCATION_LOAN="EDUCATION_LOAN",e.CREDIT_CARD="CREDIT_CARD",e.BUSINESS_LOAN="BUSINESS_LOAN",e.GOLD_LOAN="GOLD_LOAN",e.OTHER="OTHER"}(L||(L={})),function(e){e.EMI="EMI",e.PREPAYMENT="PREPAYMENT",e.PARTIAL_PAYMENT="PARTIAL_PAYMENT",e.INTEREST_ONLY="INTEREST_ONLY"}(S||(S={})),function(e){e.STOCKS="STOCKS",e.MUTUAL_FUNDS="MUTUAL_FUNDS",e.CRYPTO="CRYPTO",e.REAL_ESTATE="REAL_ESTATE",e.GOLD="GOLD",e.BONDS="BONDS",e.PPF="PPF",e.EPF="EPF",e.NSC="NSC",e.ELSS="ELSS",e.FD="FD",e.RD="RD",e.ETF="ETF",e.OTHER="OTHER"}(I||(I={})),function(e){e.ZERODHA="ZERODHA",e.GROWW="GROWW",e.ANGEL_ONE="ANGEL_ONE",e.UPSTOX="UPSTOX",e.PAYTM_MONEY="PAYTM_MONEY",e.KUVERA="KUVERA",e.COIN_DCBBANK="COIN_DCBBANK",e.HDFC_SECURITIES="HDFC_SECURITIES",e.ICICI_DIRECT="ICICI_DIRECT",e.KOTAK_SECURITIES="KOTAK_SECURITIES",e.SBI_SECURITIES="SBI_SECURITIES",e.BANK_BRANCH="BANK_BRANCH",e.POST_OFFICE="POST_OFFICE",e.OTHER="OTHER"}(O||(O={})),function(e){e.BUY="BUY",e.SELL="SELL",e.DIVIDEND="DIVIDEND",e.BONUS="BONUS",e.SPLIT="SPLIT",e.SIP_INSTALLMENT="SIP_INSTALLMENT",e.INTEREST="INTEREST",e.MATURITY="MATURITY"}(R||(R={})),function(e){e.ACTIVE="ACTIVE",e.PAUSED="PAUSED",e.COMPLETED="COMPLETED",e.CANCELLED="CANCELLED"}(D||(D={})),function(e){e.MONTHLY="MONTHLY",e.QUARTERLY="QUARTERLY",e.WEEKLY="WEEKLY",e.YEARLY="YEARLY"}(o||(o={}));let P="force-dynamic";async function Y(e){try{let e=new Date,E=new Date;E.setMonth(e.getMonth()+3);let t=await M._.bill.findMany({where:{isActive:!0}}),n=0;for(let e of t){let t=new Date(e.nextDueDate);for(;t<=E;)switch(!await M._.billInstance.findFirst({where:{billId:e.id,dueDate:{gte:new Date(t.getFullYear(),t.getMonth(),t.getDate()),lt:new Date(t.getFullYear(),t.getMonth(),t.getDate()+1)}}})&&(await M._.billInstance.create({data:{billId:e.id,dueDate:new Date(t),amount:e.amount}}),n++),e.frequency){case N.WEEKLY:t.setDate(t.getDate()+7);break;case N.MONTHLY:t.setMonth(t.getMonth()+1);break;case N.QUARTERLY:t.setMonth(t.getMonth()+3);break;case N.HALF_YEARLY:t.setMonth(t.getMonth()+6);break;case N.YEARLY:t.setFullYear(t.getFullYear()+1)}await M._.bill.update({where:{id:e.id},data:{nextDueDate:t}})}return await M._.billInstance.updateMany({where:{dueDate:{lt:e},status:"PENDING"},data:{status:"OVERDUE"}}),_.NextResponse.json({message:`Generated ${n} bill instances`,generatedCount:n})}catch(e){return console.error("Error generating bill instances:",e),_.NextResponse.json({error:"Failed to generate bill instances"},{status:500})}}let c=new C.AppRouteRouteModule({definition:{kind:u.x.APP_ROUTE,page:"/api/bills/generate/route",pathname:"/api/bills/generate",filename:"route",bundlePath:"app/api/bills/generate/route"},resolvedPagePath:"/home/ubuntu/moneymitra/app/app/api/bills/generate/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:U,staticGenerationAsyncStorage:d,serverHooks:p}=c,F="/api/bills/generate/route";function g(){return(0,l.patchFetch)({serverHooks:p,staticGenerationAsyncStorage:d})}},6059:(e,E,t)=>{t.d(E,{_:()=>A,db:()=>a});var n=t(3524);let A=globalThis.prisma??new n.PrismaClient,a=A}};var E=require("../../../../webpack-runtime.js");E.C(e);var t=e=>E(E.s=e),n=E.X(0,[5942,3786],()=>t(4744));module.exports=n})();