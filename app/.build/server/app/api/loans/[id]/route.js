"use strict";(()=>{var e={};e.id=6136,e.ids=[6136],e.modules={3524:e=>{e.exports=require("@prisma/client")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},5578:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>g,patchFetch:()=>w,requestAsyncStorage:()=>h,routeModule:()=>m,serverHooks:()=>x,staticGenerationAsyncStorage:()=>y});var n={};r.r(n),r.d(n,{DELETE:()=>c,GET:()=>l,PUT:()=>d,dynamic:()=>p});var a=r(921),o=r(7380),s=r(4185),i=r(3878),u=r(9958);let p="force-dynamic";async function l(e,{params:t}){try{let e=await u._.loan.findUnique({where:{id:t.id},include:{category:!0,payments:{include:{transaction:!0},orderBy:{paymentDate:"desc"}}}});if(!e)return i.NextResponse.json({error:"Loan not found"},{status:404});return i.NextResponse.json(e)}catch(e){return console.error("Error fetching loan:",e),i.NextResponse.json({error:"Failed to fetch loan"},{status:500})}}async function d(e,{params:t}){try{let{name:r,loanType:n,principalAmount:a,interestRate:o,tenure:s,startDate:p,description:l,categoryId:d}=await e.json(),c=parseFloat(a),m=parseFloat(o)/100/12,h=parseInt(s),y=m>0?c*m*Math.pow(1+m,h)/(Math.pow(1+m,h)-1):c/h,x=new Date(p);x.setMonth(x.getMonth()+h);let g=await u._.loan.update({where:{id:t.id},data:{name:r,loanType:n,principalAmount:c,interestRate:parseFloat(o),emiAmount:y,tenure:h,startDate:new Date(p),endDate:x,description:l,categoryId:d||null},include:{category:!0,payments:!0}});return i.NextResponse.json(g)}catch(e){return console.error("Error updating loan:",e),i.NextResponse.json({error:"Failed to update loan"},{status:500})}}async function c(e,{params:t}){try{return await u._.loan.delete({where:{id:t.id}}),i.NextResponse.json({success:!0})}catch(e){return console.error("Error deleting loan:",e),i.NextResponse.json({error:"Failed to delete loan"},{status:500})}}let m=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/loans/[id]/route",pathname:"/api/loans/[id]",filename:"route",bundlePath:"app/api/loans/[id]/route"},resolvedPagePath:"/home/ubuntu/moneymitra/app/app/api/loans/[id]/route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:h,staticGenerationAsyncStorage:y,serverHooks:x}=m,g="/api/loans/[id]/route";function w(){return(0,s.patchFetch)({serverHooks:x,staticGenerationAsyncStorage:y})}},9958:(e,t,r)=>{r.d(t,{_:()=>a,db:()=>o});var n=r(3524);let a=globalThis.prisma??new n.PrismaClient,o=a}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[5923,7146],()=>r(5578));module.exports=n})();