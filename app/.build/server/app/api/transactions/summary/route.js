"use strict";(()=>{var t={};t.id=275,t.ids=[275],t.modules={3524:t=>{t.exports=require("@prisma/client")},399:t=>{t.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:t=>{t.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},2100:(t,e,a)=>{a.r(e),a.d(e,{originalPathname:()=>g,patchFetch:()=>h,requestAsyncStorage:()=>l,routeModule:()=>p,serverHooks:()=>y,staticGenerationAsyncStorage:()=>d});var n={};a.r(n),a.d(n,{GET:()=>m,dynamic:()=>c});var r=a(3277),o=a(5265),s=a(5356),i=a(7076),u=a(6059);let c="force-dynamic";async function m(t){try{let e;let{searchParams:a}=new URL(t.url),n=parseInt(a.get("year")||new Date().getFullYear().toString()),r=a.get("month"),o=r?parseInt(r):null,s={};if(o){let t=new Date(n,o-1,1),a=new Date(n,o,0,23,59,59);s={date:e={gte:t,lte:a}}}else{let t=new Date(n,0,1),a=new Date(n,11,31,23,59,59);s={date:e={gte:t,lte:a}}}let[c,m,p,l,d,y]=await Promise.all([u._.transaction.aggregate({where:{...s,type:"INCOME"},_sum:{amount:!0},_count:!0}),u._.transaction.aggregate({where:{...s,type:"EXPENSE"},_sum:{amount:!0},_count:!0}),u._.transaction.count({where:s}),u._.billInstance.findMany({where:{paidDate:e,status:"PAID"},include:{transaction:!0}}),u._.loanPayment.findMany({where:{paymentDate:e},include:{transaction:!0}}),u._.investmentTransaction.findMany({where:{date:e,type:{in:["BUY","SELL"]}},include:{transaction:!0}})]),g=0,h=0,w=0,_=0;y.forEach(t=>{"SELL"!==t.type||t.transaction?"BUY"===t.type&&!t.transaction&&(h+=t.amount,_++):(g+=t.amount,w++)}),l.forEach(t=>{!t.transaction&&(h+=t.amount,_++)}),d.forEach(t=>{!t.transaction&&(h+=t.amount,_++)});let f=(c._sum.amount||0)+g,x=(m._sum.amount||0)+h,E=c._count+w,v=m._count+_,P=p+w+_;return i.NextResponse.json({totalIncome:f,totalExpense:x,netBalance:f-x,incomeTransactions:E,expenseTransactions:v,totalTransactions:P,period:o?`${n}-${o.toString().padStart(2,"0")}`:n.toString()})}catch(t){return console.error("Error fetching transaction summary:",t),i.NextResponse.json({error:"Failed to fetch transaction summary"},{status:500})}}let p=new r.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/transactions/summary/route",pathname:"/api/transactions/summary",filename:"route",bundlePath:"app/api/transactions/summary/route"},resolvedPagePath:"/home/ubuntu/moneymitra/app/app/api/transactions/summary/route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:l,staticGenerationAsyncStorage:d,serverHooks:y}=p,g="/api/transactions/summary/route";function h(){return(0,s.patchFetch)({serverHooks:y,staticGenerationAsyncStorage:d})}},6059:(t,e,a)=>{a.d(e,{_:()=>r,db:()=>o});var n=a(3524);let r=globalThis.prisma??new n.PrismaClient,o=r}};var e=require("../../../../webpack-runtime.js");e.C(t);var a=t=>e(e.s=t),n=e.X(0,[5942,3786],()=>a(2100));module.exports=n})();