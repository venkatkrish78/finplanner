"use strict";(()=>{var e={};e.id=8866,e.ids=[8866],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},409:(e,t,a)=>{a.r(t),a.d(t,{originalPathname:()=>h,patchFetch:()=>x,requestAsyncStorage:()=>g,routeModule:()=>l,serverHooks:()=>y,staticGenerationAsyncStorage:()=>m});var r={};a.r(r),a.d(r,{GET:()=>p,POST:()=>d,dynamic:()=>u});var n=a(921),o=a(7380),s=a(4185),i=a(3878),c=a(2334);let u="force-dynamic";async function p(e){try{let{searchParams:t}=new URL(e.url),a=parseInt(t.get("page")||"1"),r=parseInt(t.get("limit")||"50"),n=t.get("type"),o=t.get("categoryId"),s=t.get("startDate"),u=t.get("endDate"),p=(a-1)*r,d={};n&&"ALL"!==n&&(d.type=n),o&&(d.categoryId=o),(s||u)&&(d.date={},s&&(d.date.gte=new Date(s)),u&&(d.date.lte=new Date(u)));let[l,g]=await Promise.all([c._.transaction.findMany({where:d,include:{category:!0},orderBy:{date:"desc"},skip:p,take:r}),c._.transaction.count({where:d})]);return i.NextResponse.json({transactions:l,pagination:{page:a,limit:r,total:g,pages:Math.ceil(g/r)}})}catch(e){return console.error("Error fetching transactions:",e),i.NextResponse.json({error:"Failed to fetch transactions"},{status:500})}}async function d(e){try{let t=await e.json(),a=await c._.transaction.create({data:{amount:t.amount,type:t.type,description:t.description,merchant:t.merchant,accountNumber:t.accountNumber,transactionId:t.transactionId,date:new Date(t.date),balance:t.balance,status:t.status||"SUCCESS",source:t.source||"MANUAL",rawMessage:t.rawMessage,categoryId:t.categoryId},include:{category:!0}});return i.NextResponse.json(a)}catch(e){return console.error("Error creating transaction:",e),i.NextResponse.json({error:"Failed to create transaction"},{status:500})}}let l=new n.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/transactions/route",pathname:"/api/transactions",filename:"route",bundlePath:"app/api/transactions/route"},resolvedPagePath:"/home/ubuntu/moneymitra/app/app/api/transactions/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:g,staticGenerationAsyncStorage:m,serverHooks:y}=l,h="/api/transactions/route";function x(){return(0,s.patchFetch)({serverHooks:y,staticGenerationAsyncStorage:m})}},2334:(e,t,a)=>{a.d(t,{db:()=>o,_:()=>n});let r=require("@prisma/client"),n=globalThis.prisma??new r.PrismaClient,o=n}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[5923,7146],()=>a(409));module.exports=r})();