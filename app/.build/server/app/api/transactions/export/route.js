"use strict";(()=>{var e={};e.id=7934,e.ids=[7934],e.modules={3524:e=>{e.exports=require("@prisma/client")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8721:(e,t,a)=>{a.r(t),a.d(t,{originalPathname:()=>x,patchFetch:()=>y,requestAsyncStorage:()=>l,routeModule:()=>d,serverHooks:()=>g,staticGenerationAsyncStorage:()=>m});var n={};a.r(n),a.d(n,{GET:()=>u,dynamic:()=>p});var r=a(3277),o=a(5265),s=a(5356),i=a(7076),c=a(6059);let p="force-dynamic";async function u(e){try{let{searchParams:t}=new URL(e.url),a=t.get("type"),n=t.get("categoryId"),r=t.get("startDate"),o=t.get("endDate"),s=t.get("search"),p=t.get("year"),u=t.get("month"),d={};if(a&&"all"!==a&&(d.type=a),n&&"all"!==n&&(d.categoryId=n),p){let e=parseInt(p);if(u){let t=parseInt(u),a=new Date(e,t-1,1),n=new Date(e,t,0,23,59,59);d.date={gte:a,lte:n}}else{let t=new Date(e,0,1),a=new Date(e,11,31,23,59,59);d.date={gte:t,lte:a}}}else(r||o)&&(d.date={},r&&(d.date.gte=new Date(r)),o&&(d.date.lte=new Date(o)));s&&(d.OR=[{description:{contains:s,mode:"insensitive"}},{merchant:{contains:s,mode:"insensitive"}}]);let l=(await c._.transaction.findMany({where:d,include:{category:!0},orderBy:{date:"desc"}})).map(e=>[new Date(e.date).toLocaleDateString(),e.description||"",e.merchant||"",e.category?.name||"",e.type,e.amount.toString(),e.status,e.source,e.transactionId||"",e.accountNumber||"",e.balance?.toString()||""]),m=["Date,Description,Merchant,Category,Type,Amount,Status,Source,Transaction ID,Account Number,Balance",...l.map(e=>e.map(e=>e.includes(",")||e.includes('"')||e.includes("\n")?`"${e.replace(/"/g,'""')}"`:e).join(","))].join("\n");return new i.NextResponse(m,{headers:{"Content-Type":"text/csv","Content-Disposition":'attachment; filename="transactions.csv"'}})}catch(e){return console.error("Error exporting transactions:",e),i.NextResponse.json({error:"Failed to export transactions"},{status:500})}}let d=new r.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/transactions/export/route",pathname:"/api/transactions/export",filename:"route",bundlePath:"app/api/transactions/export/route"},resolvedPagePath:"/home/ubuntu/moneymitra/app/app/api/transactions/export/route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:l,staticGenerationAsyncStorage:m,serverHooks:g}=d,x="/api/transactions/export/route";function y(){return(0,s.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:m})}},6059:(e,t,a)=>{a.d(t,{_:()=>r,db:()=>o});var n=a(3524);let r=globalThis.prisma??new n.PrismaClient,o=r}};var t=require("../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),n=t.X(0,[5942,3786],()=>a(8721));module.exports=n})();