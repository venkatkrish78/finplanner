"use strict";(()=>{var t={};t.id=933,t.ids=[933],t.modules={3524:t=>{t.exports=require("@prisma/client")},399:t=>{t.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:t=>{t.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},5423:(t,e,a)=>{a.r(e),a.d(e,{originalPathname:()=>w,patchFetch:()=>b,requestAsyncStorage:()=>p,routeModule:()=>d,serverHooks:()=>g,staticGenerationAsyncStorage:()=>m});var r={};a.r(r),a.d(r,{POST:()=>l,dynamic:()=>c});var o=a(921),n=a(7380),i=a(4185),s=a(3878),u=a(9958);let c="force-dynamic";async function l(t){try{let{goalId:e,amount:a,note:r,createTransaction:o}=await t.json(),n=await u._.$transaction(async t=>{let n=await t.goalContribution.create({data:{goalId:e,amount:parseFloat(a),note:r}}),i=await t.financialGoal.update({where:{id:e},data:{currentAmount:{increment:parseFloat(a)}}});i.currentAmount>=i.targetAmount&&await t.financialGoal.update({where:{id:e},data:{status:"COMPLETED"}});let s=null;if(o){let e=await t.category.findFirst({where:{name:"Savings"}});e||(e=await t.category.create({data:{name:"Savings",color:"#10B981",isDefault:!0}})),s=await t.transaction.create({data:{amount:parseFloat(a),type:"EXPENSE",description:`Goal contribution: ${i.name}`,date:new Date,categoryId:e.id,source:"MANUAL"}}),await t.goalContribution.update({where:{id:n.id},data:{transactionId:s.id}})}return{contribution:n,goal:i,transaction:s}});return s.NextResponse.json(n,{status:201})}catch(t){return console.error("Error creating goal contribution:",t),s.NextResponse.json({error:"Failed to create goal contribution"},{status:500})}}let d=new o.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/goals/contributions/route",pathname:"/api/goals/contributions",filename:"route",bundlePath:"app/api/goals/contributions/route"},resolvedPagePath:"/home/ubuntu/moneymitra/app/app/api/goals/contributions/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:p,staticGenerationAsyncStorage:m,serverHooks:g}=d,w="/api/goals/contributions/route";function b(){return(0,i.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:m})}},9958:(t,e,a)=>{a.d(e,{_:()=>o,db:()=>n});var r=a(3524);let o=globalThis.prisma??new r.PrismaClient,n=o}};var e=require("../../../../webpack-runtime.js");e.C(t);var a=t=>e(e.s=t),r=e.X(0,[5923,7146],()=>a(5423));module.exports=r})();