"use strict";(()=>{var e={};e.id=5322,e.ids=[5322],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},9938:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>y,patchFetch:()=>f,requestAsyncStorage:()=>m,routeModule:()=>g,serverHooks:()=>h,staticGenerationAsyncStorage:()=>v});var n={};r.r(n),r.d(n,{DELETE:()=>p,GET:()=>c,PUT:()=>d,dynamic:()=>l});var a=r(921),o=r(7380),i=r(4185),s=r(3878),u=r(2334);let l="force-dynamic";async function c(e,{params:t}){try{let e=await u._.financialGoal.findUnique({where:{id:t.id},include:{category:!0,contributions:{include:{transaction:!0},orderBy:{createdAt:"desc"}},investmentLinks:{include:{investment:{include:{category:!0}}}},investments:{include:{category:!0}}}});if(!e)return s.NextResponse.json({error:"Goal not found"},{status:404});let r=0;e.investmentLinks&&(r+=e.investmentLinks.reduce((e,t)=>t.investment.isActive?e+t.investment.currentValue*(t.allocation/100):e,0)),e.investments&&(r+=e.investments.reduce((e,t)=>t.isActive?e+t.currentValue:e,0));let n=e.currentAmount+r,a=e.targetAmount>0?n/e.targetAmount*100:0,o={...e,linkedInvestmentValue:r,dynamicProgress:a,totalProgress:n};return s.NextResponse.json(o)}catch(e){return console.error("Error fetching goal:",e),s.NextResponse.json({error:"Failed to fetch goal"},{status:500})}}async function d(e,{params:t}){try{let{name:r,description:n,goalType:a,targetAmount:o,targetDate:i,status:l,categoryId:c}=await e.json(),d=await u._.financialGoal.update({where:{id:t.id},data:{name:r,description:n,goalType:a,targetAmount:parseFloat(o),targetDate:i?new Date(i):null,status:l,categoryId:c||null},include:{category:!0,contributions:!0}});return s.NextResponse.json(d)}catch(e){return console.error("Error updating goal:",e),s.NextResponse.json({error:"Failed to update goal"},{status:500})}}async function p(e,{params:t}){try{return await u._.financialGoal.delete({where:{id:t.id}}),s.NextResponse.json({success:!0})}catch(e){return console.error("Error deleting goal:",e),s.NextResponse.json({error:"Failed to delete goal"},{status:500})}}let g=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/goals/[id]/route",pathname:"/api/goals/[id]",filename:"route",bundlePath:"app/api/goals/[id]/route"},resolvedPagePath:"/home/ubuntu/moneymitra/app/app/api/goals/[id]/route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:m,staticGenerationAsyncStorage:v,serverHooks:h}=g,y="/api/goals/[id]/route";function f(){return(0,i.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:v})}},2334:(e,t,r)=>{r.d(t,{db:()=>o,_:()=>a});let n=require("@prisma/client"),a=globalThis.prisma??new n.PrismaClient,o=a}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[5923,7146],()=>r(9938));module.exports=n})();